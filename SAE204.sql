/*CECCARELLI Luca, CLEMENT Romain, GONTIER Luke, LAFITTE Antoine */
/*Create Tables*/
CREATE TABLE LIEU(
    IDL NUMBER(5),
    NOML VARCHAR2(30),
    IDLPERE NUMBER(5),
    CONSTRAINT PK_LIEU PRIMARY KEY(IDL),
    CONSTRAINT FK_LIEU FOREIGN KEY(IDLPERE) REFERENCES LIEU(IDL)
);

CREATE TABLE STATION(
    IDS NUMBER(9),
    IDL NUMBER(5),
    TEL NUMBER(10),
    LATITUDE VARCHAR2(15),
    LONGITUDE VARCHAR2(15),
    CONSTRAINT PK_STATION PRIMARY KEY(IDS),
    CONSTRAINT FK_STATION FOREIGN KEY(IDL) REFERENCES LIEU(IDL)
);

CREATE TABLE RELEVE(
    IDR NUMBER(16),
    DATER DATE,
    IDS NUMBER(9),
    CONSTRAINT PK_RELEVE PRIMARY KEY(IDR),
    CONSTRAINT FK_RELEVE FOREIGN KEY(IDS) REFERENCES STATION(IDS)
);

CREATE TABLE MESURE(
    IDM NUMBER(17),
    NOMM VARCHAR2(15),
    MESURE NUMBER(4),
    IDR NUMBER(16),
    CHECK (MESURE>-30 AND MESURE<2000),
    CONSTRAINT PK_MESURE PRIMARY KEY(IDM),
    CONSTRAINT FK_MESURE FOREIGN KEY(IDR) REFERENCES RELEVE(IDR)
);

CREATE TABLE ALERTE(
    IDA  VARCHAR2(10),
    CATEGORIE VARCHAR2(12),
    IDL NUMBER(5),
    DATEDEB DATE,
    DATEFIN DATE,
    NIVEAU VARCHAR2(6),
    CONSTRAINT PK_ALERTE PRIMARY KEY(IDA),
    CONSTRAINT FK_ALERTE FOREIGN KEY(IDL) REFERENCES LIEU(IDL)
);

/*Table LIEU*/
/*Pays*/
INSERT INTO LIEU VALUES(250,'FRANCE', NULL);
/*Région*/
INSERT INTO LIEU VALUES(93, 'PROVENCE-ALPES-COTE-D-AZUR', 250);
INSERT INTO LIEU VALUES(11, 'ILE-DE-FRANCE', 250);
/*Departement*/
INSERT INTO LIEU VALUES(04, 'ALPES-DE-HAUTE-PROVENCE', 93);
INSERT INTO LIEU VALUES(83, 'VAR', 93);
INSERT INTO LIEU VALUES(75, 'PARIS', 11);
INSERT INTO LIEU VALUES(77, 'SEINE-ET-MARNE', 11);
/*Ville*/
INSERT INTO LIEU VALUES(04210, 'VALENSOLE', 04);
INSERT INTO LIEU VALUES(04070, 'DIGNE-LES-BAINS', 04);
INSERT INTO LIEU VALUES(83137, 'TOULON', 83);
INSERT INTO LIEU VALUES(83050, 'DRAGUIGNAN', 83);
INSERT INTO LIEU VALUES(75056, 'PARIS', 75);
INSERT INTO LIEU VALUES(77000, 'MELUN', 77);
INSERT INTO LIEU VALUES(77500, 'CHELLES', 77);

/*Table STATION*/
INSERT INTO STATION VALUES(04070009, 04070,0492367190,'44°04''12" Nord', '6°11''12" Est' );/*Digne*/
INSERT INTO STATION VALUES(04230001, 04210,0492748235,'43°50''22" Nord', '6°00''03" Est' );/*Valensole*/
INSERT INTO STATION VALUES(83137001, 83137,0492748236,'43°06''57” Nord', '5°54''02" Est'); /* Toulon */
INSERT INTO STATION VALUES(75114001, 75056,0153906714,'48°49''18" Nord', '2°20''16" Est' );/*Paris*/
INSERT INTO STATION VALUES(20002389, 75056,0153906713,'48°48''20" Nord', '2°20''19" Est' );/*Paris2*/
INSERT INTO STATION VALUES(75114002, 75056,0153906712,'48°49''25" Nord', '2°20''20" Est' );/*Paris3*/
INSERT INTO STATION VALUES(75114003, 75056,0153906711,'48°49''50" Nord', '2°20''26" Est' );/*Paris4*/
INSERT INTO STATION VALUES(75114004, 75056,0153906710,'48°49''40" Nord', '2°20''30" Est' );/*Paris5*/
INSERT INTO STATION VALUES(75114005, 75056,0153914710,'48°49''45" Nord', '2°21''33" Est' );/*Paris6*/
INSERT INTO STATION VALUES(77108001, 77500,0164728484, '48°53''25" Nord', '2°36''25” Est');/*CHELLES*/
INSERT INTO STATION VALUES(77306001, 77000,0164523303, '48°36''37" Nord', '2°40''46" Est');/*MELUN*/

/*Table Releve*/
/*Digne*/
INSERT INTO RELEVE VALUES( 0407000901012208, DATE'2022-01-01',  04070009); /*8H*/
INSERT INTO RELEVE VALUES( 0407000901012221, DATE'2022-01-01',  04070009);/*21H*/
INSERT INTO RELEVE VALUES( 0407000911022106, DATE'2021-02-11',  04070009);/*6H*/
INSERT INTO RELEVE VALUES( 0407000911022123, DATE'2021-02-11',  04070009);/*23H*/

/*Valensole*/
INSERT INTO RELEVE VALUES( 0423000117032107, DATE'2021-03-17',  04230001);
INSERT INTO RELEVE VALUES( 0423000117032120, DATE'2021-03-17',  04230001);
INSERT INTO RELEVE VALUES( 0423000124052003, DATE'2020-05-24',  04230001);
INSERT INTO RELEVE VALUES( 0423000124052017, DATE'2020-05-24',  04230001);

/*Toulon*/
INSERT INTO RELEVE VALUES( 8313700119022206, DATE'2022-02-19',  83137001);
INSERT INTO RELEVE VALUES( 8313700119022210, DATE'2022-02-19',  83137001);

INSERT INTO RELEVE VALUES( 8313700123012107, DATE'2021-01-23',  83137001);
INSERT INTO RELEVE VALUES( 8313700123012116, DATE'2021-01-23',  83137001);

/*Paris*/
INSERT INTO RELEVE VALUES( 7511400130042003, DATE'2020-04-30',  75114001);
INSERT INTO RELEVE VALUES( 7511400130042014, DATE'2020-04-30',  75114001);

INSERT INTO RELEVE VALUES( 7511400123062109, DATE'2021-06-23',  75114001);
INSERT INTO RELEVE VALUES( 7511400123062119, DATE'2021-06-23',  75114001);

/*Chelles*/
INSERT INTO RELEVE VALUES( 7710800109072210, DATE'2022-07-09',  77108001);
INSERT INTO RELEVE VALUES( 7710800109072218, DATE'2022-07-09',  77108001);

INSERT INTO RELEVE VALUES( 7710800129082111, DATE'2021-08-29',  77108001);
INSERT INTO RELEVE VALUES( 7710800129082116, DATE'2021-08-29',  77108001);

/*Meulun*/
INSERT INTO RELEVE VALUES( 7730600104092212, DATE'2022-09-04',  77306001);
INSERT INTO RELEVE VALUES( 7730600104092215, DATE'2022-09-04',  77306001);

INSERT INTO RELEVE VALUES( 7730600114102110, DATE'2021-10-14',  77306001);
INSERT INTO RELEVE VALUES( 7730600114102113, DATE'2021-10-14',  77306001);

/*Table Mesure*/
INSERT INTO MESURE VALUES(04070009010122081,'Temperature',3,0407000901012208);
INSERT INTO MESURE VALUES(04070009010122082,'Precipitation',1536,0407000901012208);
INSERT INTO MESURE VALUES(04070009010122083,'Vent',47,0407000901012208);
INSERT INTO MESURE VALUES(04070009010122084,'Ensoleillement',235,0407000901012208);

INSERT INTO MESURE VALUES(04070009010122211,'Temperature',13,0407000901012221);
INSERT INTO MESURE VALUES(04070009010122212,'Precipitation',985,0407000901012221);
INSERT INTO MESURE VALUES(04070009010122213,'Vent',76,0407000901012221);
INSERT INTO MESURE VALUES(04070009010122214,'Ensoleillement',312,0407000901012221);

INSERT INTO MESURE VALUES(04070009110221061,'Temperature',-1,0407000911022106);
INSERT INTO MESURE VALUES(04070009110221062,'Precipitation',1071,0407000911022106);
INSERT INTO MESURE VALUES(04070009110221063,'Vent',12,0407000911022106);
INSERT INTO MESURE VALUES(04070009110221064,'Ensoleillement',247,0407000911022106);

INSERT INTO MESURE VALUES(04070009110221231,'Temperature',10,0407000911022123);
INSERT INTO MESURE VALUES(04070009110221232,'Precipitation',709,0407000911022123);
INSERT INTO MESURE VALUES(04070009110221233,'Vent',23,0407000911022123);
INSERT INTO MESURE VALUES(04070009110221234,'Ensoleillement',346,0407000911022123);

INSERT INTO MESURE VALUES(04230001170321071,'Temperature',-10,0423000117032107);
INSERT INTO MESURE VALUES(04230001170321072,'Precipitation',1076,0423000117032107);
INSERT INTO MESURE VALUES(04230001170321073,'Vent',12,0423000117032107);
INSERT INTO MESURE VALUES(04230001170321074,'Ensoleillement',256,0423000117032107);

INSERT INTO MESURE VALUES(04230001170321201,'Temperature',1,0423000117032120);
INSERT INTO MESURE VALUES(04230001170321202,'Precipitation',1018,0423000117032120);
INSERT INTO MESURE VALUES(04230001170321203,'Vent',57,0423000117032120);
INSERT INTO MESURE VALUES(04230001170321204,'Ensoleillement',249,0423000117032120);

INSERT INTO MESURE VALUES(04230001240520031,'Temperature',-8,0423000124052003);
INSERT INTO MESURE VALUES(04230001240520032,'Precipitation',1180,0423000124052003);
INSERT INTO MESURE VALUES(04230001240520033,'Vent',22,0423000124052003);
INSERT INTO MESURE VALUES(04230001240520034,'Ensoleillement',343,0423000124052003);

INSERT INTO MESURE VALUES(04230001240520171,'Temperature',-3,0423000124052017);
INSERT INTO MESURE VALUES(04230001240520172,'Precipitation',785,0423000124052017);
INSERT INTO MESURE VALUES(04230001240520173,'Vent',29,0423000124052017);
INSERT INTO MESURE VALUES(04230001240520174,'Ensoleillement',222,0423000124052017);

INSERT INTO MESURE VALUES(83137001190222061,'Temperature',2,8313700119022206);
INSERT INTO MESURE VALUES(83137001190222062,'Precipitation',708,8313700119022206);
INSERT INTO MESURE VALUES(83137001190222063,'Vent',69,8313700119022206);
INSERT INTO MESURE VALUES(83137001190222064,'Ensoleillement',387,8313700119022206);

INSERT INTO MESURE VALUES(83137001190222101,'Temperature',3,8313700119022210);
INSERT INTO MESURE VALUES(83137001190222102,'Precipitation',1106,8313700119022210);
INSERT INTO MESURE VALUES(83137001190222103,'Vent',61,8313700119022210);
INSERT INTO MESURE VALUES(83137001190222104,'Ensoleillement',262,8313700119022210);

INSERT INTO MESURE VALUES(83137001230121071,'Temperature',-1,8313700123012107);
INSERT INTO MESURE VALUES(83137001230121072,'Precipitation',1023,8313700123012107);
INSERT INTO MESURE VALUES(83137001230121073,'Vent',71,8313700123012107);
INSERT INTO MESURE VALUES(83137001230121074,'Ensoleillement',239,8313700123012107);

INSERT INTO MESURE VALUES(83137001230121161,'Temperature',4,8313700123012116);
INSERT INTO MESURE VALUES(83137001230121162,'Precipitation',1187,8313700123012116);
INSERT INTO MESURE VALUES(83137001230121163,'Vent',58,8313700123012116);
INSERT INTO MESURE VALUES(83137001230121164,'Ensoleillement',344,8313700123012116);

INSERT INTO MESURE VALUES(75114001300420031,'Temperature',-5,7511400130042003);
INSERT INTO MESURE VALUES(75114001300420032,'Precipitation',1020,7511400130042003);
INSERT INTO MESURE VALUES(75114001300420033,'Vent',13,7511400130042003);
INSERT INTO MESURE VALUES(75114001300420034,'Ensoleillement',346,7511400130042003);

INSERT INTO MESURE VALUES(75114001300420141,'Temperature',-9,7511400130042014);
INSERT INTO MESURE VALUES(75114001300420142,'Precipitation',1630,7511400130042014);
INSERT INTO MESURE VALUES(75114001300420143,'Vent',46,7511400130042014);
INSERT INTO MESURE VALUES(75114001300420144,'Ensoleillement',393,7511400130042014);

INSERT INTO MESURE VALUES(75114001230621091,'Temperature',-8,7511400123062109);
INSERT INTO MESURE VALUES(75114001230621092,'Precipitation',820,7511400123062109);
INSERT INTO MESURE VALUES(75114001230621093,'Vent',46,7511400123062109);
INSERT INTO MESURE VALUES(75114001230621094,'Ensoleillement',301,7511400123062109);

INSERT INTO MESURE VALUES(75114001230621191,'Temperature',5,7511400123062119);
INSERT INTO MESURE VALUES(75114001230621192,'Precipitation',1575,7511400123062119);
INSERT INTO MESURE VALUES(75114001230621193,'Vent',14,7511400123062119);
INSERT INTO MESURE VALUES(75114001230621194,'Ensoleillement',147,7511400123062119);

INSERT INTO MESURE VALUES(77108001090722101,'Temperature',16,7710800109072210);
INSERT INTO MESURE VALUES(77108001090722102,'Precipitation',1155,7710800109072210);
INSERT INTO MESURE VALUES(77108001090722103,'Vent',36,7710800109072210);
INSERT INTO MESURE VALUES(77108001090722104,'Ensoleillement',249,7710800109072210);

INSERT INTO MESURE VALUES(77108001090722181,'Temperature',3,7710800109072218);
INSERT INTO MESURE VALUES(77108001090722182,'Precipitation',1507,7710800109072218);
INSERT INTO MESURE VALUES(77108001090722183,'Vent',64,7710800109072218);
INSERT INTO MESURE VALUES(77108001090722184,'Ensoleillement',315,7710800109072218);

INSERT INTO MESURE VALUES(77108001290821111,'Temperature',2,7710800129082111);
INSERT INTO MESURE VALUES(77108001290821112,'Precipitation',1195,7710800129082111);
INSERT INTO MESURE VALUES(77108001290821113,'Vent',34,7710800129082111);
INSERT INTO MESURE VALUES(77108001290821114,'Ensoleillement',387,7710800129082111);

INSERT INTO MESURE VALUES(77108001290821161,'Temperature',4,7710800129082116);
INSERT INTO MESURE VALUES(77108001290821162,'Precipitation',1014,7710800129082116);
INSERT INTO MESURE VALUES(77108001290821163,'Vent',33,7710800129082116);
INSERT INTO MESURE VALUES(77108001290821164,'Ensoleillement',170,7710800129082116);

INSERT INTO MESURE VALUES(77306001040922121,'Temperature',-3,7730600104092212);
INSERT INTO MESURE VALUES(77306001040922122,'Precipitation',1458,7730600104092212);
INSERT INTO MESURE VALUES(77306001040922123,'Vent',36,7730600104092212);
INSERT INTO MESURE VALUES(77306001040922124,'Ensoleillement',398,7730600104092212);

INSERT INTO MESURE VALUES(77306001040922151,'Temperature',-2,7730600104092215);
INSERT INTO MESURE VALUES(77306001040922152,'Precipitation',1234,7730600104092215);
INSERT INTO MESURE VALUES(77306001040922153,'Vent',73,7730600104092215);
INSERT INTO MESURE VALUES(77306001040922154,'Ensoleillement',371,7730600104092215);

INSERT INTO MESURE VALUES(77306001141021101,'Temperature',4,7730600114102110);
INSERT INTO MESURE VALUES(77306001141021102,'Precipitation',1049,7730600114102110);
INSERT INTO MESURE VALUES(77306001141021103,'Vent',22,7730600114102110);
INSERT INTO MESURE VALUES(77306001141021104,'Ensoleillement',180,7730600114102110);

INSERT INTO MESURE VALUES(77306001141021131,'Temperature',16,7730600114102113);
INSERT INTO MESURE VALUES(77306001141021132,'Precipitation',1018,7730600114102113);
INSERT INTO MESURE VALUES(77306001141021133,'Vent',59,7730600114102113);
INSERT INTO MESURE VALUES(77306001141021134,'Ensoleillement',232,7730600114102113);

/*ALERTE*/
INSERT INTO ALERTE VALUES(9314101910,'Crue',93,DATE'2021-10-14',DATE'2021-10-19','Vert');
INSERT INTO ALERTE VALUES(9325092609,'Orage',93,DATE'2021-09-25',DATE'2021-09-26','Jaune');
INSERT INTO ALERTE VALUES(9325080409,'Vent violent',93,DATE'2021-08-25',DATE'2021-09-04','Orange');
INSERT INTO ALERTE VALUES(9327050106,'Neige',93,DATE'2021-05-27',DATE'2021-06-01','Rouge');
INSERT INTO ALERTE VALUES(9316091909,'Canicule',93,DATE'2021-09-16',DATE'2021-09-19','Vert');
INSERT INTO ALERTE VALUES(9309111011,'Crue',93,DATE'2021-11-09',DATE'2021-11-10','Jaune');
INSERT INTO ALERTE VALUES(9311011701,'Orage',93,DATE'2021-01-11',DATE'2021-01-17','Orange');
INSERT INTO ALERTE VALUES(9303091309,'Vent violent',93,DATE'2021-09-03',DATE'2021-09-13','Rouge');
INSERT INTO ALERTE VALUES(9307030903,'Neige',93,DATE'2021-03-07',DATE'2021-03-09','Vert');
INSERT INTO ALERTE VALUES(9301110311,'Canicule',93,DATE'2021-11-01',DATE'2021-11-03','Jaune');
INSERT INTO ALERTE VALUES(9319032903,'Crue',93,DATE'2021-03-19',DATE'2021-03-29','Orange');
INSERT INTO ALERTE VALUES(9301110811,'Orage',93,DATE'2021-11-01',DATE'2021-11-08','Rouge');
INSERT INTO ALERTE VALUES(9319062606,'Vent violent',93,DATE'2021-06-19',DATE'2021-06-26','Vert');
INSERT INTO ALERTE VALUES(9303110711,'Neige',93,DATE'2021-11-03',DATE'2021-11-07','Jaune');
INSERT INTO ALERTE VALUES(9318082708,'Canicule',93,DATE'2021-08-18',DATE'2021-08-27','Orange');
INSERT INTO ALERTE VALUES(9327070808,'Crue',93,DATE'2021-07-27',DATE'2021-08-08','Rouge');
INSERT INTO ALERTE VALUES(9317051805,'Orage',93,DATE'2021-05-17',DATE'2021-05-18','Vert');
INSERT INTO ALERTE VALUES(9308041404,'Vent violent',93,DATE'2021-04-08',DATE'2021-04-14','Jaune');
INSERT INTO ALERTE VALUES(9313092009,'Neige',93,DATE'2021-09-13',DATE'2021-09-20','Orange');
INSERT INTO ALERTE VALUES(9304101010,'Canicule',93,DATE'2021-10-04',DATE'2021-10-10','Rouge');
INSERT INTO ALERTE VALUES(9326022802,'Crue',93,DATE'2021-02-26',DATE'2021-02-28','Vert');
INSERT INTO ALERTE VALUES(9319112811,'Orage',93,DATE'2021-11-19',DATE'2021-11-28','Jaune');
INSERT INTO ALERTE VALUES(9324092609,'Vent violent',93,DATE'2021-09-24',DATE'2021-09-26','Orange');
INSERT INTO ALERTE VALUES(9321042204,'Neige',93,DATE'2021-04-21',DATE'2021-04-22','Rouge');
INSERT INTO ALERTE VALUES(9318022302,'Canicule',93,DATE'2021-02-18',DATE'2021-02-23','Vert');
INSERT INTO ALERTE VALUES(9316052305,'Crue',93,DATE'2021-05-16',DATE'2021-05-23','Jaune');
INSERT INTO ALERTE VALUES(9328050706,'Orage',93,DATE'2021-05-28',DATE'2021-06-07','Orange');
INSERT INTO ALERTE VALUES(9302100910,'Vent violent',93,DATE'2021-10-02',DATE'2021-10-09','Rouge');
INSERT INTO ALERTE VALUES(9321102910,'Neige',93,DATE'2021-10-21',DATE'2021-10-29','Vert');
INSERT INTO ALERTE VALUES(9315042304,'Canicule',93,DATE'2021-04-15',DATE'2021-04-23','Jaune');
INSERT INTO ALERTE VALUES(9312092109,'Crue',93,DATE'2021-09-12',DATE'2021-09-21','Orange');
INSERT INTO ALERTE VALUES(9324010302,'Orage',93,DATE'2021-01-24',DATE'2021-02-03','Rouge');
INSERT INTO ALERTE VALUES(9302091109,'Vent violent',93,DATE'2021-09-02',DATE'2021-09-11','Vert');
INSERT INTO ALERTE VALUES(9328050106,'Neige',93,DATE'2021-05-28',DATE'2021-06-01','Jaune');
INSERT INTO ALERTE VALUES(9305031203,'Canicule',93,DATE'2021-03-05',DATE'2021-03-12','Orange');
INSERT INTO ALERTE VALUES(9327110212,'Crue',93,DATE'2021-11-27',DATE'2021-12-02','Rouge');
INSERT INTO ALERTE VALUES(9316042304,'Orage',93,DATE'2021-04-16',DATE'2021-04-23','Vert');
INSERT INTO ALERTE VALUES(9310071907,'Vent violent',93,DATE'2021-07-10',DATE'2021-07-19','Jaune');
INSERT INTO ALERTE VALUES(9305011501,'Neige',93,DATE'2021-01-05',DATE'2021-01-15','Orange');
INSERT INTO ALERTE VALUES(9307051405,'Canicule',93,DATE'2021-05-07',DATE'2021-05-14','Rouge');

INSERT INTO ALERTE VALUES(1116111711,'Crue',11,DATE'2021-11-16',DATE'2021-11-17','Vert');
INSERT INTO ALERTE VALUES(1114022402,'Orage',11,DATE'2021-02-14',DATE'2021-02-24','Jaune');
INSERT INTO ALERTE VALUES(1121102610,'Vent violent',11,DATE'2021-10-21',DATE'2021-10-26','Orange');
INSERT INTO ALERTE VALUES(1128030904,'Neige',11,DATE'2021-03-28',DATE'2021-04-09','Rouge');
INSERT INTO ALERTE VALUES(1129061007,'Canicule',11,DATE'2021-06-29',DATE'2021-07-10','Vert');
INSERT INTO ALERTE VALUES(1111111611,'Crue',11,DATE'2021-11-11',DATE'2021-11-16','Jaune');
INSERT INTO ALERTE VALUES(1121042704,'Orage',11,DATE'2021-04-21',DATE'2021-04-27','Orange');
INSERT INTO ALERTE VALUES(1119022102,'Vent violent',11,DATE'2021-02-19',DATE'2021-02-21','Rouge');
INSERT INTO ALERTE VALUES(1103011301,'Neige',11,DATE'2021-01-03',DATE'2021-01-13','Vert');
INSERT INTO ALERTE VALUES(1106021502,'Canicule',11,DATE'2021-02-06',DATE'2021-02-15','Jaune');
INSERT INTO ALERTE VALUES(1112081408,'Crue',11,DATE'2021-08-12',DATE'2021-08-14','Orange');
INSERT INTO ALERTE VALUES(1108041004,'Orage',11,DATE'2021-04-08',DATE'2021-04-10','Rouge');
INSERT INTO ALERTE VALUES(1105051405,'Vent violent',11,DATE'2021-05-05',DATE'2021-05-14','Vert');
INSERT INTO ALERTE VALUES(1105111211,'Neige',11,DATE'2021-11-05',DATE'2021-11-12','Jaune');
INSERT INTO ALERTE VALUES(1120102310,'Canicule',11,DATE'2021-10-20',DATE'2021-10-23','Orange');
INSERT INTO ALERTE VALUES(1102070907,'Crue',11,DATE'2021-07-02',DATE'2021-07-09','Rouge');
INSERT INTO ALERTE VALUES(1124032903,'Orage',11,DATE'2021-03-24',DATE'2021-03-29','Vert');
INSERT INTO ALERTE VALUES(1125050106,'Vent violent',11,DATE'2021-05-25',DATE'2021-06-01','Jaune');
INSERT INTO ALERTE VALUES(1120062306,'Neige',11,DATE'2021-06-20',DATE'2021-06-23','Orange');
INSERT INTO ALERTE VALUES(1116061706,'Canicule',11,DATE'2021-06-16',DATE'2021-06-17','Rouge');
INSERT INTO ALERTE VALUES(1113051705,'Crue',11,DATE'2021-05-13',DATE'2021-05-17','Vert');
INSERT INTO ALERTE VALUES(1112021302,'Orage',11,DATE'2021-02-12',DATE'2021-02-13','Jaune');
INSERT INTO ALERTE VALUES(1117021802,'Vent violent',11,DATE'2021-02-17',DATE'2021-02-18','Orange');
INSERT INTO ALERTE VALUES(1103060506,'Neige',11,DATE'2021-06-03',DATE'2021-06-05','Rouge');
INSERT INTO ALERTE VALUES(1107021702,'Canicule',11,DATE'2021-02-07',DATE'2021-02-17','Vert');
INSERT INTO ALERTE VALUES(1117022602,'Crue',11,DATE'2021-02-17',DATE'2021-02-26','Jaune');
INSERT INTO ALERTE VALUES(1103071207,'Orage',11,DATE'2021-07-03',DATE'2021-07-12','Orange');
INSERT INTO ALERTE VALUES(1118051905,'Vent violent',11,DATE'2021-05-18',DATE'2021-05-19','Rouge');
INSERT INTO ALERTE VALUES(1125020303,'Neige',11,DATE'2021-02-25',DATE'2021-03-03','Vert');
INSERT INTO ALERTE VALUES(1119082708,'Canicule',11,DATE'2021-08-19',DATE'2021-08-27','Jaune');
INSERT INTO ALERTE VALUES(1121040205,'Crue',11,DATE'2021-04-21',DATE'2021-05-02','Orange');
INSERT INTO ALERTE VALUES(1103110611,'Orage',11,DATE'2021-11-03',DATE'2021-11-06','Rouge');
INSERT INTO ALERTE VALUES(1120070108,'Vent violent',11,DATE'2021-07-20',DATE'2021-08-01','Vert');
INSERT INTO ALERTE VALUES(1107010801,'Neige',11,DATE'2021-01-07',DATE'2021-01-08','Jaune');
INSERT INTO ALERTE VALUES(1111011801,'Canicule',11,DATE'2021-01-11',DATE'2021-01-18','Orange');
INSERT INTO ALERTE VALUES(1102030503,'Crue',11,DATE'2021-03-02',DATE'2021-03-05','Rouge');
INSERT INTO ALERTE VALUES(1112052205,'Orage',11,DATE'2021-05-12',DATE'2021-05-22','Vert');
INSERT INTO ALERTE VALUES(1103110811,'Vent violent',11,DATE'2021-11-03',DATE'2021-11-08','Jaune');
INSERT INTO ALERTE VALUES(1122092309,'Neige',11,DATE'2021-09-22',DATE'2021-09-23','Orange');
INSERT INTO ALERTE VALUES(1126080609,'Canicule',11,DATE'2021-08-26',DATE'2021-09-06','Rouge');

COMMIT;


/*Requete Partie 2*/
/*Q1*/
SELECT NOML, COUNT(DISTINCT IDA) 
FROM LIEU, ALERTE
WHERE LIEU.IDL = ALERTE.IDL AND LIEU.IDL IN (SELECT IDL FROM LIEU WHERE IDLPERE IN (
SELECT IDL FROM LIEU WHERE IDLPERE is Null) )
GROUP BY NOML;

/*Q2*/
SELECT CATEGORIE, AVG(DATEFIN-DATEDEB) DUREE_MOYENNE FROM ALERTE A
JOIN LIEU L ON A.IDL = L.IDL
WHERE L.NOML = 'PROVENCE-ALPES-COTE-D-AZUR'
GROUP BY CATEGORIE;

/*Q3*/
SELECT NOML FROM LIEU L
JOIN STATION S ON S.IDL = L.IDL
GROUP BY NOML HAVING COUNT(DISTINCT IDS)>5;
            
/*Q4*/
SELECT NOML, MAX(MESURE.MESURE), MIN(MESURE.MESURE) FROM MESURE,LIEU,STATION,RELEVE
WHERE LIEU.IDL = STATION.IDL
    AND STATION.IDS = RELEVE.IDS
    AND RELEVE.IDR = MESURE.IDR
    AND NOMM = 'Temperature'
GROUP BY NOML;

/*Q5*/
SELECT NOML, COUNT(*) NOMBRE_TOT_ALERTES FROM LIEU,ALERTE
WHERE LIEU.IDL = ALERTE.IDL
    AND NOML IN (SELECT NOML FROM LIEU, ALERTE
                WHERE LIEU.IDL = ALERTE.IDL
                    AND CATEGORIE = 'Crue'
                GROUP BY NOML HAVING COUNT(*) >= 3)
GROUP BY NOML;

/*Q6*/
SELECT NOML, NB_CRUE, NB_ORAGE
FROM (SELECT COUNT(*) NB_ORAGE, IDL FROM ALERTE WHERE CATEGORIE = 'Orage' GROUP BY IDL) ORAGE,
    (SELECT COUNT(*) NB_CRUE, IDL FROM ALERTE WHERE CATEGORIE = 'Crue' GROUP BY IDL) CRUE,
    LIEU
WHERE LIEU.IDL = ORAGE.IDL
    AND LIEU.IDL = CRUE.IDL
GROUP BY NOML, NB_CRUE, NB_ORAGE;

/*Q7*/
/* La requete ne pourra pas marcher car dans le jeu de données il n'y a pas de RELEVE qui date du jour où la requete sera compilé (car SYSDATE rend la date du jour meme)*/
SELECT NOML, ABS(TEMPMAX - LIEU_TEMP_MAX) FROM (SELECT MAX(MESURE) TEMPMAX FROM MESURE,RELEVE
                                            WHERE MESURE.IDR = RELEVE.IDR
                                                AND DATER = DATE'2021-02-11'/*Dans le cas où on est le 11 fevrier 2021 SYSDATE sera egale à la valur inserée par force brute / Remarque : on peut remplacer DATE'2021-02-11' par SYSDATE*/
                                                AND NOMM = 'Temperature'),
                                            (SELECT MAX(MESURE) LIEU_TEMP_MAX, LIEU.IDL FROM MESURE,RELEVE,STATION,LIEU
                                            WHERE MESURE.IDR = RELEVE.IDR
                                                AND RELEVE.IDS = STATION.IDS
                                                AND LIEU.IDL = STATION.IDL
                                                AND NOMM = 'Temperature'
                                            GROUP BY LIEU.IDL) MAX_PAR_LIEU,
                                            LIEU
WHERE LIEU.IDL = MAX_PAR_LIEU.IDL;


/*Q8*/
SELECT NOML FROM LIEU,STATION, RELEVE, MESURE
    WHERE LIEU.IDL = STATION.IDL
        AND STATION.IDS = RELEVE.IDS
        AND MESURE.IDR = RELEVE.IDR
        AND NOMM = 'Temperature'
        AND MESURE = (SELECT MIN(MESURE) FROM MESURE,RELEVE
                        WHERE MESURE.IDR = RELEVE.IDR
                            AND (DATER -DATE'2021-01-01')>=0
                            AND (DATE'2021-01-31' - DATER)<=0
                            AND NOMM = 'Temperature');

/*Q9*/
SELECT IDS FROM STATION
MINUS
SELECT IDS FROM STATION,ALERTE,LIEU
                    WHERE IDLPERE = ALERTE.IDL
                        AND CATEGORIE = 'Orage'
                        AND DATEDEB = DATE'2021-05-10'
                        AND STATION.IDL = LIEU.IDL;
                        
/*Q10*/
SELECT LPAD('-', 2*LEVEL, ' ') || NOML FROM LIEU
CONNECT BY PRIOR IDLPERE = IDL
START WITH IDL =(SELECT IDL FROM STATION WHERE IDS = 20002389);

/*Q11*/
SELECT MESURE.IDR, IDS FROM MESURE,RELEVE
WHERE MESURE.IDR = RELEVE.IDR
    AND NOMM IS NOT NULL
GROUP BY MESURE.IDR, IDS
HAVING COUNT(DISTINCT NOMM) = (SELECT COUNT(DISTINCT NOMM) FROM MESURE
                              WHERE NOMM IS NOT NULL);
                              